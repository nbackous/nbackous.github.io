window.cashmusic=function(){if(null!=window.cashmusic)var h=window.cashmusic;else{h={embeds:{whitelist:"",all:[]},embedded:!1,eventlist:{},geo:null,get:{},lightbox:!1,loaded:!1,name:"",options:"",path:"",scripts:[],sessionid:null,soundplayer:!1,storage:{},templates:{},_init:function(){var b,a=window.cashmusic;a.get.qs=window.location.search.substring(1);a.get.params=!1;if(a.get.qs){a.get.params={};var c=a.get.qs.split("&");for(b=0;b<c.length;b++){var d=c[b].split("=");a.get.params[d[0]]=decodeURIComponent(d[1])}}a.get.params.debug&&
(a.debug.show=!0);self!==top?a._initEmbed():a.name="main window";a.session.start();d=document.querySelectorAll("a.cashmusic.gallery,div.cashmusic.gallery");(-1!==a.options.indexOf("lightboxvideo")||0<d.length)&&a.loadScript(a.path+"/lightbox/lightbox.js");0<document.querySelectorAll("a.cashmusic.soundplayer,div.cashmusic.soundplayer").length&&a.loadScript(a.path+"/soundplayer/soundplayer.js");a.events.add(window,"message",function(b){-1!==a.embeds.whitelist.indexOf(b.origin)&&a._handleMessage(b)});
a.embeds.whitelist+=window.location.href.split("/").slice(0,3).join("/");a.get.params.location&&(a.embeds.whitelist+=a.get.params.location.split("/").slice(0,3).join("/"));if(a.embedded)a.loaded=Date.now(),a._drawQueuedEmbeds(),a.debug.store("session id set: "+a.sessionid),a.debug.show&&a.debug.out("finished initializing",a),a.events.fire(a,"ready",a.loaded);else{a.get.qs&&(-1!==a.get.qs.indexOf("element_id")||-1!==a.get.qs.indexOf("handlequery"))&&window.history&&history.pushState&&history.pushState(null,
null,window.location.href.split("?")[0]);a.overlay.create();var e=0;b=setInterval(function(){100>e&&(!a.geo||!a.sessionid&&-1===a.options.indexOf("standalone"))?e++:(a.sessionid?a.debug.store("session id set: "+a.sessionid):a.debug.store("no session. standalone mode."),a.debug.store("geo acquired: "+a.geo),a.debug.store("total delay: "+100*e+"ms"),a.loaded=Date.now(),clearInterval(b),a._drawQueuedEmbeds(),a.debug.show&&a.debug.out("finished initializing",a),a.events.fire(a,"ready",a.loaded))},100)}},
_drawQueuedEmbeds:function(){var b=window.cashmusic;"object"==typeof b.storage.elementQueue&&b.storage.elementQueue.forEach(function(a){b.embed(a[0],a[1],a[2],a[3],a[4],a[5])})},_initEmbed:function(){var b=window.cashmusic;b.embedded=!0;var a=document.querySelector("div.cashmusic.element");a&&(b.storage.embedheight=b.measure.scrollheight(),b.events.fire(b,"resize",b.storage.embedheight),a=a.className.split(" "),b.events.fire(b,"identify",[a[2],a[3].substr(3)]),b.name="element #"+a[3].substr(3)+" / "+
a[2],window.setInterval(function(){var a=b.measure.scrollheight();a!=b.storage.embedheight&&(b.storage.embedheight=a,b.events.fire(b,"resize",a))},250),(a=b.getQueryVariable("cssoverride"))&&b.styles.injectCSS(a,!0));for(var a=document.getElementsByTagName("form"),c=0;c<a.length;c++){var d=document.createElement("input");d.setAttribute("type","hidden");d.setAttribute("name","embedded_element");d.setAttribute("value","1");a[c].appendChild(d)}},_handleMessage:function(b){for(var a=window.cashmusic,
c=JSON.parse(b.data),d=c.data,e,g=0;g<a.embeds.all.length;g++)if(a.embeds.all[g].el.contentWindow===b.source){e=a.embeds.all[g];break}var f=!1;if(d.target)for(g=0;g<a.embeds.all.length;g++)if(a.embeds.all[g].id==d.target){f=a.embeds.all[g].el.contentWindow;break}switch(c.type){case "resize":e.el.height=d;e.el.style.height=d+"px";break;case "identify":e.id==d[1]&&(e.type=d[0]);break;case "checkoutdata":a.events.fire(a,"checkoutdata",d);break;case "overlayreveal":a.overlay.reveal(d.innerContent,d.wrapClass);
a.events.fire(a,"overlayopened","");break;case "overlayhide":a.overlay.hide();a.events.fire(a,"overlayhidden","");break;case "addoverlaytrigger":a.overlay.addOverlayTrigger(d.content,d.classname,d.ref);break;case "injectcss":a.styles.injectCSS(d.css,d.important);break;case "addclass":a.styles.addClass(d.el,d.classname);break;case "removeclass":a.styles.removeClass(d.el,d.classname);break;case "swapclasses":a.styles.swapClasses(d.el,d.oldclass,d.newclass);break;case "begincheckout":var k=f;k||(k=b.source);
a.checkout?a.checkout.begin(d,k):a.loadScript(a.path+"/checkout/checkout.js",function(){a.checkout.begin(d,k)});f=!1}f&&a.events.fire(a,c.type,d,f)},contentLoaded:function(b){var a=!1,c=!0,d=window.document,e=d.documentElement,g=function(c){if("readystatechange"!=c.type||"complete"==d.readyState)h.events.remove("load"==c.type?window:d,c.type,g),!a&&(a=!0)&&b.call(window,c.type||c)},f=function(){try{e.doScroll("left")}catch(k){setTimeout(f,50);return}g("poll")};if("complete"==d.readyState)b.call(window,
"lazy");else{if(d.createEventObject&&e.doScroll){try{c=!window.frameElement}catch(k){}c&&f()}this.events.add(d,"DOMContentLoaded",g);this.events.add(d,"readystatechange",g);this.events.add(d,"load",g)}},embed:function(b,a,c,d,e,g){var f=window.cashmusic;"string"!==typeof b||"h"!=b.substr(0,1)&&"/"!=b.substr(0,1)||(b=[a,a=b][0]);var k=document.querySelectorAll("script"),h=k[k.length-1];if(f.loaded){"object"===typeof b&&(c=b.lightboxed?b.lightboxed:!1,d=b.lightboxtxt?b.lightboxtxt:!1,e=b.targetnode?
b.targetnode:!1,g=b.cssoverride?b.cssoverride:!1,a=b.endpoint?b.endpoint:!1,b=b.elementid?b.elementid:!1);h="string"===typeof e?document.querySelector(e):e;a||(a=f.path);var l=f.buildEmbedIframe(a,b,g,c?"lightbox=1":!1);if(h)if(c){var m=document.createElement("span");m.className="cashmusic embed link";d||(d="open element");f.overlay.create(function(){var a=document.createElement("a");a.href="";a.target="_blank";a.innerHTML=d;m.appendChild(a);h.parentNode.insertBefore(m,h);(function(){f.events.add(a,
"click",function(a){f.overlay.reveal(l);a.preventDefault();return!1})})()})}else h.parentNode.insertBefore(l,h)}else"object"!==typeof f.storage.elementQueue&&(f.storage.elementQueue=[]),"object"===typeof b?b.targetnode||(b.targetnode=h,arguments[0]=b):arguments[4]=h,f.storage.elementQueue.push(arguments)},buildEmbedIframe:function(b,a,c,d){var e=window.cashmusic;b=b.replace(/\/$/,"")+"/request/embed/"+a+"?location="+encodeURIComponent(window.location.href);e.geo&&(b+="&geo="+encodeURIComponent(e.geo));
c&&(b+="&cssoverride="+encodeURIComponent(c));d&&(b+="&"+d);e.get.params&&-1===(""+d).indexOf("lightbox=1")&&(e.get.params.element_id==a||e.get.params.handlequery)&&(b+="&"+e.get.qs);e.sessionid&&(b+="&session_id="+e.sessionid);e.debug.show&&(b+="&debug=1");c=document.createElement("iframe");c.src=b;c.id="cm-"+(new Date).getTime();c.className="cashmusic embed";c.style.width="100%";c.style.height="0";c.style.border="0";c.style.overflow="hidden";c.scrolling="no";d=b.split("/").slice(0,3).join("/");
-1===e.embeds.whitelist.indexOf(d)&&(e.embeds.whitelist+=d);e.embeds.all.push({el:c,id:a,type:""});e.debug.store("building iframe for element #"+a);return c},getTemplate:function(b,a){var c=window.cashmusic,d=c.templates;void 0!==d[b]?a(d[b]):(this.ajax.jsonp(c.path+"/templates/"+b+".js","callback",function(c){d[b]=c.template;a(c.template)},"cashmusic"+b+"Callback"),document.querySelectorAll('link[href="'+c.path+"/templates/"+b+'.css"]').length||c.styles.injectCSS(c.path+"/templates/"+b+".css"))},
addEventListener:function(b,a){var c=window.cashmusic;c.eventlist.hasOwnProperty(b)||(c.eventlist[b]=[]);c.eventlist[b].push(a)},removeEventListener:function(b,a){var c=window.cashmusic;if(c.eventlist.hasOwnProperty(b)){var d=c.eventlist[b].indexOf(a);-1!=d&&c.eventlist[b].splice(d,1)}},dispatchEvent:function(b){var a=window.cashmusic;if(a.eventlist.hasOwnProperty(b.type)){var c;for(c=0;c<a.eventlist[b.type].length;c++)if(a.eventlist[b.type][c])a.eventlist[b.type][c](b)}},loadScript:function(b,a){var c=
window.cashmusic;if(-1<c.scripts.indexOf(b))"function"===typeof a&&a();else{c.scripts.push(b);var d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");e.src=b;var g=!1;e.onload=e.onreadystatechange=function(){g||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(g=!0,"function"===typeof a&&a(),e.onload=e.onreadystatechange=null,d&&e.parentNode&&d.removeChild(e))};d.insertBefore(e,d.firstChild)}c.debug.show&&(c.loaded?c.debug.out("loaded script: "+
b):c.debug.store("loaded script: "+b))},getQueryVariable:function(b){for(var a=window.location.search.substring(1).split("&"),c=0;c<a.length;c++){var d=a[c].split("=");if(d[0]==b)return decodeURIComponent(d[1])}return!1},debug:{show:!1,store:function(b,a){var c=window.cashmusic;c.storage.debug||(c.storage.debug=[]);c.storage.debug.push({msg:b,o:a})},out:function(b,a){var c=window.cashmusic;c.storage.debug?(console.groupCollapsed("%c\u24c3 "+c.name+": "+b,"color: #FF00FF;"),a&&console.log("   attachment: %o",
a),c.storage.debug.forEach(function(a){a.o?console.log("   "+a.msg+" %o",a.o):console.log("   "+a.msg)}),console.groupEnd(),delete c.storage.debug):a?console.log("%c\u24c3 "+c.name+": "+b+" %o","color: #FF00FF;",a):console.log("%c\u24c3 "+c.name+": "+b,"color: #FF00FF;")}},ajax:{getXHR:function(){try{return new XMLHttpRequest}catch(b){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return!1}}}},send:function(b,a,c,d){var e=window.cashmusic,
g="POST";a?e.sessionid&&(a+="&session_id="+e.sessionid):(g="GET",a=null,e.sessionid&&(b=-1===b.indexOf("?")?b+("?session_id="+e.sessionid):b+("&session_id="+e.sessionid)));var f=this.getXHR();f&&(f.open(g,b,!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==g&&f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"function"==typeof c&&(f.onreadystatechange=function(){4===f.readyState&&(200===f.status?c(f.responseText):"function"===typeof d&&d(f.responseText))}),f.send(a))},
jsonp:function(b,a,c,d){b=b||"";a=a||"";c=c||function(){};d=d||!1;"function"==typeof a&&(c=a,a="callback");if(d){var e=d;var g=function(){};"function"==typeof window[e]&&(g=window[e])}else e="jsonp"+Math.round(1000001*Math.random());window[e]=function(a){c(a);d?g(a):delete window[e]};b=-1===b.indexOf("?")?b+"?":b+"&";var f=document.createElement("script");f.setAttribute("src",b+a+"="+e);document.getElementsByTagName("head")[0].appendChild(f)},encodeForm:function(b){if("object"!==typeof b)return!1;
var a="";b=b.elements||b;for(var c=0;c<b.length;c++)"checkbox"===b[c].type||"radio"===b[c].type?b[c].checked&&(a+=(a.length?"&":"")+encodeURIComponent(b[c].name)+"="+encodeURIComponent(b[c].value)):a+=(a.length?"&":"")+encodeURIComponent(b[c].name)+"="+encodeURIComponent(b[c].value);return a},getHeaderForURL:function(b,a,c){var d=this.getXHR();d.open("HEAD",b);d.onreadystatechange=function(){this.readyState==this.DONE&&c(this.getResponseHeader(a))};d.send()}},events:{add:function(b,a,c){b.attachEvent?
(b["e"+a+c]=c,b[a+c]=function(){b["e"+a+c](window.event)},b.attachEvent("on"+a,b[a+c])):b.addEventListener(a,c,!1)},remove:function(b,a,c){b.detachEvent?(b.detachEvent("on"+a,b[a+c]),b[a+c]=null):b.removeEventListener(a,c,!1)},fire:function(b,a,c,d){var e=window.cashmusic;d&&d.postMessage(JSON.stringify({type:a,data:c}),"*");document.dispatchEvent?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!1,!1,c),b.dispatchEvent(d)):(d=document.createEventObject(),d.detail=c,b.fireEvent("on"+a,d));
e.embedded&&e.events.relay(a,c);e.debug.show&&(e.loaded?e.debug.out("firing "+a+" event.",c):e.debug.store("firing "+a+" event.",c))},relay:function(b,a){window.parent.postMessage(JSON.stringify({type:b,data:a}),"*")}},session:{start:function(){var b=window.cashmusic;b.sessionid||-1!==b.options.indexOf("standalone")||(b.get.params.session_id?b.sessionid=b.get.params.session_id:b.session.getid(window.location.href.split("/").slice(0,3).join("/")))},setid:function(b){var a=window.cashmusic;a.sessionid=
b.id;if(!a.embedded)try{var c=localStorage.getItem("sessions"),c=c?JSON.parse(c):{};c[window.location.href.split("/").slice(0,3).join("/")]={id:b.id,expiration:b.expiration};localStorage.setItem("sessions",JSON.stringify(c))}catch(d){}},getid:function(b){var a=window.cashmusic;!a.sessionid&&a.get.params.session_id&&(a.sessionid=a.get.params.session_id);if(!a.sessionid&&!a.embedded){var c=!1;try{c=localStorage.getItem("sessions")}catch(d){c=!1}c&&(c=JSON.parse(c),c[b]&&(c[b].expiration>Math.floor((new Date).getTime()/
1E3)?a.sessionid=c[b].id:(delete c[b],localStorage.setItem("sessions",JSON.stringify(c)))))}null!==a.sessionid||a.embedded||-1!==a.options.indexOf("standalone")||(a.sessionid=!1,b=a.path.replace("public","api")+"/verbose/system/startjssession",b+="?ts="+(new Date).getTime(),a.ajax.send(b,!1,function(b){if(b){b=JSON.parse(b);var c=JSON.parse(b.payload);a.session.setid(c);a.events.fire(a,"sessionstarted",b.payload)}},function(b){a.options+=" standalone"}));return a.sessionid}},measure:{viewport:function(){return{x:window.innerWidth||
document.body.offsetWidth||0,y:window.innerHeight||document.body.offsetHeight||0}},scrollheight:function(){var b=document.body,a=document.documentElement;return Math.max(b.scrollHeight,a.scrollHeight,b.offsetHeight,a.offsetHeight,b.clientHeight,a.clientHeight)}},overlay:{content:!1,close:!1,callbacks:[],create:function(b){var a=window.cashmusic,c=a.overlay;a.styles.injectCSS(a.path+"/templates/overlay.css");c.content=document.createElement("div");c.content.className="cm-overlay";c.close=document.createElement("div");
c.close.className="cm-close";a.events.add(window,"keyup",function(a){27==a.keyCode&&c.content.parentNode==document.body&&c.hide()});a.events.add(c.close,"click",function(a){c.content.parentNode==document.body&&c.hide()});"function"===typeof b&&b()},hide:function(){var b=window.cashmusic,a=b.overlay,c=document.body;if(b.embedded)b.events.fire(b,"overlayhide");else{a.content.style.opacity=0;for(b.events.fire(b,"overlayclosed","");a.content.firstChild;)a.content.removeChild(a.content.firstChild);c.removeChild(a.close);
c.removeChild(a.content);a=document.querySelectorAll(".cm-overlaytrigger");if(0<a.length)for(var c=0,d=a.length;c<d;c++)a[c].style.visibility="visible";b.styles.removeClass(document.documentElement,"cm-noscroll")}},reveal:function(b,a){var c=window.cashmusic,d=c.overlay,e=document.body;if(c.embedded)c.events.fire(c,"overlayreveal",{innerContent:b,wrapClass:a});else{1==d.content.style.opacity&&(d.content.innerHTML="");var g=document.createElement("div");g.className="cm-position";var f=document.createElement("div");
f.className=a?a:"cm-element";if("string"===typeof b)f.innerHTML=b;else if(b.endpoint&&b.element){var h="";c.sessionid&&(h="&session_id="+c.sessionid);h=c.buildEmbedIframe(b.endpoint,b.element,!1,"lightbox=1&state="+b.state+h);f.appendChild(h)}else f.appendChild(b);g.appendChild(f);d.content.appendChild(g);c.styles.hasClass(document.documentElement,"cm-noscroll")||c.styles.addClass(document.documentElement,"cm-noscroll");1!=d.content.style.opacity&&(d.content.style.opacity=0,e.appendChild(d.content),
e.appendChild(d.close),window.getComputedStyle(d.content).opacity,d.content.style.opacity=1)}},addOverlayTrigger:function(b,a,c){var d=window.cashmusic,e=document.body;if(d.embedded)d.events.fire(d,"addoverlaytrigger",{content:b,classname:a,ref:c});else{var g=document.createElement("div");g.className=a.toString()+" cm-overlaytrigger";d.events.add(g,"click",function(a){d.overlay.reveal(b);this.style.visibility="hidden";a.preventDefault();return!1});e.appendChild(g);d.storage[c]=g;d.events.fire(d,"triggeradded",
c)}}},styles:{resolveElement:function(b){return"string"===typeof b?"storage:"==b.substr(0,8)?window.cashmusic.storage[b.substr(8)]:document.querySelector(b):b},addClass:function(b,a,c){var d=window.cashmusic;if(c&&d.embedded)d.events.fire(d,"addclass",{el:b,classname:a});else if(b=d.styles.resolveElement(b))b.className=b.className+" "+a},hasClass:function(b,a){return-1<(" "+b.className+" ").indexOf(" "+a+" ")},injectCSS:function(b,a,c){void 0===c&&(c=!1);var d=window.cashmusic;c&&d.embedded?d.events.fire(d,
"injectcss",{css:b,important:a}):(d=document.getElementsByTagName("head")[0]||document.documentElement,"http"==b.substr(0,4)?(c=document.createElement("link"),c.rel="stylesheet",c.href=b):(c=document.createElement("style"),c.innerHTML=b),c.type="text/css",a?d.appendChild(c):d.insertBefore(c,d.firstChild))},removeClass:function(b,a,c){var d=window.cashmusic;if(c&&d.embedded)d.events.fire(d,"removeclass",{el:b,classname:a});else if(b=d.styles.resolveElement(b))b.className=(" "+b.className+" ").replace(" "+
a+" "," ").replace(/^\s+/,"").replace(/\s+$/,"")},swapClasses:function(b,a,c,d){var e=window.cashmusic;if(d&&e.embedded)e.events.fire(e,"swapclasses",{el:b,oldclass:a,newclass:c});else if(b=e.styles.resolveElement(b))b.className=(" "+b.className+" ").replace(" "+a+" "," "+c+" ").replace(/^\s+/,"").replace(/\s+$/,"")}}};var l=document.querySelector('script[src$="cashmusic.js"]');l&&(h.path=l.src.substr(0,l.src.length-13));h.options=String(l.getAttribute("data-options"));self===top&&h.ajax.getHeaderForURL("https://javascript-cashmusic.netdna-ssl.com/cashmusic.js",
"GeoIp-Data",function(b){h.geo=b});var n=function(){var b=document.querySelectorAll('script[src$="cashmusic.js"]');"object"==typeof b&&Array.prototype.slice.call(b).forEach(function(a){var b=a.getAttribute("data-element");b&&h.embed({elementid:b,targetnode:a})})};h.contentLoaded(function(){-1!==h.options.indexOf("lazy")?setTimeout(function(){h._init(h);n()},1E3):(h._init(h),n())})}return h}();